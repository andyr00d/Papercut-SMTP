<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
    <title>Message preview</title>
    <link rel="stylesheet" href="css/jquery-ui-1.10.4-smoothness.css" />
    <link rel="stylesheet" href="css/bootstrap-3.3.2.min.css" />
    <link rel="stylesheet" href="css/style.css" />
</head>
<body>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" type="text/javascript"></script>
    <script type="text/javascript">
        $(document).ready(function () {
            console.log("ready!");
            
            var messageId = window.location.href.substring(window.location.href.indexOf("=") + 1);
            console.log(messageId)

            var xhttp = new XMLHttpRequest();
            xhttp.onreadystatechange = function () {
                if (this.readyState == 4 && this.status == 200) {
                    // Typical action to be performed when the document is ready:
                    //document.getElementById("HtmlBody").innerHTML = xhttp.responseText;
                    console.log(xhttp.responseText.match(new RegExp("<body>" + "(.*)" + "</body>"))[0]);
                    //document.getElementById("preview-html").innerHTML = xhttp.responseText;
                    //$(xhttp.responseText.match(new RegExp("<body>" + "(.*)" + "</body>"))[0]).appendTo("body");

                }
            };
            xhttp.open("GET", 'http://localhost:37408/api/messages/' + messageId, true);
            xhttp.send();
        });

    </script>
</body>
</html>